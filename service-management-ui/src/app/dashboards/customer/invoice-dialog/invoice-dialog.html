<div class="invoice-wrapper" *ngIf="!loading && invoice">

  <!-- HEADER -->
  <div class="invoice-header">
    <div>
      <h2>INVOICE</h2>
      <p class="invoice-id">Invoice #{{ invoice.invoiceId }}</p>
    </div>
    <div class="brand">
      <mat-icon>receipt_long</mat-icon>
      <span>Service Management System</span>
    </div>
  </div>

  <hr />

  <!-- CUSTOMER DETAILS -->
  <div class="section">
    <h3>Bill To</h3>
    <p><b>{{ invoice.customerName }}</b></p>
    <p>{{ invoice.customerEmail }}</p>
    <p>{{ invoice.customerPhone || 'N/A' }}</p>
  </div>

  <!-- SERVICE DETAILS -->
  <div class="section two-col">
    <div>
      <h3>Service Details</h3>
      <p><b>Service:</b> {{ invoice.serviceName }}</p>
      <p><b>Issue:</b> {{ invoice.issueDescription }}</p>
    </div>

    <div class="right">
      <p><b>Invoice Date:</b></p>
      <p>{{ invoice.invoiceDate }}</p>
    </div>
  </div>

  <!-- AMOUNT TABLE -->
  <table class="amount-table">
    <thead>
      <tr>
        <th>Description</th>
        <th>Amount</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{ invoice.serviceName }}</td>
        <td>₹{{ invoice.totalAmount }}</td>
      </tr>
    </tbody>
  </table>

  <!-- TOTAL -->
  <div class="total-row">
    <span>Total Amount</span>
    <span>₹{{ invoice.totalAmount }}</span>
  </div>

  <!-- STATUS -->
  <div class="status-row">
    <mat-icon
      [ngClass]="{
        pending: invoice.paymentStatus === 'Pending',
        waiting: invoice.paymentStatus === 'WaitingForAdminApproval',
        paid: invoice.paymentStatus === 'Paid'
      }"
    >
      {{ invoice.paymentStatus === 'Paid' ? 'check_circle' : 'hourglass_top' }}
    </mat-icon>

    <span>{{ invoice.paymentStatus }}</span>
  </div>

  <!-- ACTIONS -->
  <div class="actions">
    <button
      *ngIf="invoice.paymentStatus === 'Pending'"
      mat-raised-button
      color="primary"
      (click)="makePayment()">
      <mat-icon>payments</mat-icon>
      Make Payment
    </button>

    <p *ngIf="invoice.paymentStatus === 'WaitingForAdminApproval'" class="waiting-text">
      Payment submitted. Waiting for admin approval.
    </p>
  </div>

</div>

<div *ngIf="loading" class="loading">
  Loading invoice...
</div>
